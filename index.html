<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qu√≠mica I - Primer Trimestre</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Fuentes Google -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: #f3f4f6;
            -webkit-font-smoothing: antialiased;
        }

        /* Animaciones personalizadas */
        .animate-enter { animation: enter 0.6s cubic-bezier(0.16, 1, 0.3, 1); }
        .animate-slide-in { animation: slideIn 0.5s cubic-bezier(0.16, 1, 0.3, 1); }
        .animate-pulse-soft { animation: pulseSoft 2s infinite; }

        @keyframes enter {
            from { opacity: 0; transform: translateY(20px) scale(0.98); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        @keyframes pulseSoft {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }
        
        /* Estilos ricos para el contenido de las lecciones */
        .lesson-content h3 { font-size: 1.5rem; font-weight: 700; color: #1e3a8a; margin-top: 2rem; margin-bottom: 0.75rem; letter-spacing: -0.025em; }
        .lesson-content p { margin-bottom: 1.25rem; line-height: 1.75; color: #374151; font-size: 1.05rem; }
        .lesson-content ul { list-style-type: none; padding-left: 0; margin-bottom: 1.5rem; }
        .lesson-content li { position: relative; padding-left: 1.5rem; margin-bottom: 0.5rem; color: #4b5563; }
        .lesson-content li::before { content: "‚Ä¢"; position: absolute; left: 0; color: #3b82f6; font-weight: bold; font-size: 1.2em; }
        .lesson-content strong { color: #111827; font-weight: 600; }
        .lesson-content .highlight-box { background-color: #eff6ff; border-left: 4px solid #3b82f6; padding: 1.5rem; border-radius: 0.75rem; margin: 1.5rem 0; box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); }
        
        /* Utilitarios de UI */
        .glass-panel { background: rgba(255, 255, 255, 0.7); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.5); }
        .btn-hover { transition: all 0.2s ease; }
        .btn-hover:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3); }

        /* --- NUEVO: Estilos para controles de desplazamiento (Soluci√≥n H5P) --- */
        .scroll-controls {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            z-index: 9999; /* M√°xima prioridad visual */
        }
        .scroll-btn {
            background-color: #2563eb; /* Azul brillante */
            color: white;
            border: 2px solid white;
            border-radius: 50%;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            transition: all 0.2s ease;
            opacity: 0.9;
        }
        .scroll-btn:hover {
            transform: scale(1.1);
            background-color: #1d4ed8;
            opacity: 1;
        }
        .scroll-btn:active {
            transform: scale(0.95);
            background-color: #1e40af;
        }
    </style>
</head>
<body class="text-slate-800 min-h-screen flex flex-col relative">

    <!-- --- NUEVO: Botones Flotantes para Navegar (Scroll) --- -->
    <div class="scroll-controls">
        <button onclick="scrollWindow(-400)" class="scroll-btn" aria-label="Subir" title="Subir">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="m18 15-6-6-6 6"/></svg>
        </button>
        <button onclick="scrollWindow(400)" class="scroll-btn" aria-label="Bajar" title="Bajar">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
        </button>
    </div>

    <!-- Navbar Simple -->
    <nav class="sticky top-0 z-50 bg-white/80 backdrop-blur-md border-b border-gray-200 px-6 py-4">
        <div class="max-w-4xl mx-auto flex justify-between items-center">
            <div class="flex items-center gap-2 text-slate-700 cursor-pointer hover:text-blue-600 transition" onclick="if(state.view !== 'cover') setView('cover')">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-600"><path d="M6 18h8"/><path d="M3 22h18"/><path d="M14 22a7 7 0 1 0 0-14h-1"/><path d="M9 14h2"/><path d="M9 12a2 2 0 0 1-2-2V6h6v4a2 2 0 0 1-2 2Z"/><path d="M12 6V3a1 1 0 0 0-1-1H9a1 1 0 0 0-1 1v3"/></svg>
                <span class="font-bold tracking-tight text-lg">Qu√≠mica I</span>
            </div>
            <span class="text-xs font-bold bg-blue-100 text-blue-700 px-3 py-1 rounded-full uppercase tracking-wider">Trimestre 1</span>
        </div>
    </nav>

    <!-- Contenedor Principal -->
    <div id="app" class="max-w-4xl mx-auto py-8 px-4 flex-grow w-full">
        <!-- El contenido se renderizar√° aqu√≠ din√°micamente con JavaScript -->
    </div>

    <!-- L√ìGICA DE LA APLICACI√ìN -->
    <script>
        // --- NUEVO: Funci√≥n para controlar el desplazamiento ---
        function scrollWindow(amount) {
            window.scrollBy({
                top: amount,
                behavior: 'smooth'
            });
        }

        // --- DATOS DEL CURSO ---
        const courseData = {
            info: {
                title: "Primer Trimestre",
                topic: "Estructura At√≥mica y Periodicidad",
                grade: "1ero Bachillerato",
                description: "Este trimestre sienta las bases de la qu√≠mica moderna. Viajaremos desde la concepci√≥n filos√≥fica del √°tomo hasta el modelo mecano-cu√°ntico actual.",
                outcomes: [
                    "Describir la evoluci√≥n de los modelos at√≥micos.",
                    "Calcular n√∫meros cu√°nticos.",
                    "Relacionar la estructura electr√≥nica con la Tabla Peri√≥dica.",
                    "Identificar propiedades peri√≥dicas."
                ]
            },
            lessons: [
                {
                    id: 1,
                    title: "1. Evoluci√≥n de los Modelos At√≥micos",
                    duration: "45 min",
                    content: `
                        <p class="text-lg">La idea del √°tomo comenz√≥ en Grecia con Dem√≥crito ("a-tomos", sin divisi√≥n), pero la ciencia moderna retom√≥ el concepto siglos despu√©s.</p>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-8">
                            <div class="bg-white p-5 rounded-xl border border-blue-100 shadow-sm hover:shadow-md transition">
                                <h4 class="font-bold text-blue-700 mb-2 text-lg">J. Dalton (1803)</h4>
                                <p class="text-sm text-slate-600">Imagin√≥ el √°tomo como una esfera s√≥lida e indivisible, como una bola de billar.</p>
                            </div>
                            <div class="bg-white p-5 rounded-xl border border-blue-100 shadow-sm hover:shadow-md transition">
                                <h4 class="font-bold text-blue-700 mb-2 text-lg">J.J. Thomson (1904)</h4>
                                <p class="text-sm text-slate-600">Descubri√≥ el electr√≥n. Modelo del "Bud√≠n de Pasas".</p>
                            </div>
                            <div class="bg-white p-5 rounded-xl border border-blue-100 shadow-sm hover:shadow-md transition">
                                <h4 class="font-bold text-blue-700 mb-2 text-lg">E. Rutherford (1911)</h4>
                                <p class="text-sm text-slate-600">Descubri√≥ el n√∫cleo denso y positivo. Modelo planetario.</p>
                            </div>
                            <div class="bg-white p-5 rounded-xl border border-blue-100 shadow-sm hover:shadow-md transition">
                                <h4 class="font-bold text-blue-700 mb-2 text-lg">Niels Bohr (1913)</h4>
                                <p class="text-sm text-slate-600">Electrones en √≥rbitas de energ√≠a definida.</p>
                            </div>
                        </div>
                    `,
                    quiz: {
                        question: "¬øQu√© cient√≠fico descubri√≥ el n√∫cleo at√≥mico?",
                        options: ["J.J. Thomson", "John Dalton", "Ernest Rutherford", "Niels Bohr"],
                        correct: 2 
                    }
                },
                {
                    id: 2,
                    title: "2. El Modelo Mecano-Cu√°ntico",
                    duration: "60 min",
                    content: `
                        <p>El modelo actual no ve al electr√≥n como una part√≠cula girando, sino como una onda de probabilidad.</p>
                        <div class="highlight-box">
                            <h4 class="font-bold text-indigo-900 mb-3 text-lg">Los N√∫meros Cu√°nticos</h4>
                            <ul class="space-y-2">
                                <li><strong>n (Principal):</strong> Nivel de energ√≠a (1, 2, 3...).</li>
                                <li><strong>l (Secundario):</strong> Forma del orbital (s, p, d, f).</li>
                                <li><strong>ml (Magn√©tico):</strong> Orientaci√≥n espacial.</li>
                                <li><strong>ms (Spin):</strong> Giro del electr√≥n.</li>
                            </ul>
                        </div>
                    `,
                    quiz: {
                        question: "¬øQu√© n√∫mero cu√°ntico indica la forma del orbital?",
                        options: ["Principal (n)", "Secundario (l)", "Magn√©tico (ml)", "Spin (ms)"],
                        correct: 1
                    }
                },
                {
                    id: 3,
                    title: "3. Configuraci√≥n Electr√≥nica",
                    duration: "50 min",
                    content: `
                        <p>Es la distribuci√≥n de electrones. Seguimos el <strong>Diagrama de Moeller</strong>.</p>
                        <div class="bg-slate-800 text-white p-6 rounded-xl font-mono text-sm my-6 shadow-lg">
                            <p class="text-slate-400 mb-1">// Carbono (Z=6)</p>
                            <p class="text-green-400 mb-4">1s¬≤ 2s¬≤ 2p¬≤</p>
                            
                            <p class="text-slate-400 mb-1">// Cloro (Z=17)</p>
                            <p class="text-green-400">1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤ 3p‚Åµ</p>
                        </div>
                    `,
                    quiz: {
                        question: "¬øConfiguraci√≥n correcta del Sodio (Na, Z=11)?",
                        options: ["1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬≤", "1s¬≤ 2s¬≤ 2p‚Å∂ 3s¬π", "1s¬≤ 2s¬≤ 2p‚Åµ 3s¬≤", "1s¬≤ 2s¬≤ 2p‚Å∂"],
                        correct: 1
                    }
                },
                {
                    id: 4,
                    title: "4. Tabla Peri√≥dica",
                    duration: "40 min",
                    content: `
                        <p>Organizada por N√∫mero At√≥mico (Z) creciente.</p>
                        <div class="grid grid-cols-2 gap-4 mb-6">
                            <div class="bg-white p-4 rounded-lg border text-center shadow-sm">
                                <div class="font-bold text-indigo-600 mb-1">Grupos</div>
                                <div class="text-xs text-gray-500">Columnas Verticales</div>
                            </div>
                            <div class="bg-white p-4 rounded-lg border text-center shadow-sm">
                                <div class="font-bold text-indigo-600 mb-1">Periodos</div>
                                <div class="text-xs text-gray-500">Filas Horizontales</div>
                            </div>
                        </div>
                        <p><strong>Electronegatividad:</strong> Aumenta hacia arriba y a la derecha. El Fl√∫or (F) es el m√°s electronegativo.</p>
                    `,
                    quiz: {
                        question: "¬øC√≥mo var√≠a el radio at√≥mico?",
                        options: ["Aumenta derecha/arriba", "Aumenta izquierda/abajo", "No cambia", "Aleatorio"],
                        correct: 1
                    }
                }
            ]
        };

        // --- ESTADO ---
        let state = {
            view: 'cover', 
            completedLessons: [],
            activeLessonId: null
        };

        // --- ICONOS SVG ---
        const icons = {
            atom: `<svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="1"/><path d="M20.2 20.2c2.04-2.03.02-7.36-4.5-11.9-4.54-4.52-9.87-6.54-11.9-4.5-2.04 2.03-.02 7.36 4.5 11.9 4.54 4.52 9.87 6.54 11.9 4.5Z"/><path d="M15.7 15.7c4.52-4.54 6.54-9.87 4.5-11.9-2.03-2.04-7.36-.02-11.9 4.5-4.52 4.54-6.54 9.87-4.5 11.9 2.03 2.04 7.36.02 11.9-4.5Z"/></svg>`,
            check: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"/></svg>`,
            arrowRight: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>`,
            arrowLeft: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></svg>`,
            award: `<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/></svg>`,
            play: `<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" stroke="none"><polygon points="5 3 19 12 5 21 5 3"/></svg>`,
            lock: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="11" x="3" y="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>`
        };

        // --- RENDERIZADO ---

        function render() {
            const app = document.getElementById('app');
            let html = '';

            // 1. VISTA: PORTADA (COVER)
            if (state.view === 'cover') {
                html += `
                    <div class="min-h-[600px] flex flex-col items-center justify-center text-center p-8 rounded-3xl bg-gradient-to-br from-blue-600 via-indigo-600 to-violet-700 text-white shadow-2xl animate-enter relative overflow-hidden">
                        
                        <!-- Efecto de fondo sutil -->
                        <div class="absolute top-0 left-0 w-full h-full opacity-10 pointer-events-none">
                            <div class="absolute top-10 right-10 transform rotate-12">${icons.atom}</div>
                            <div class="absolute bottom-10 left-10 transform -rotate-12 scale-75">${icons.atom}</div>
                        </div>

                        <div class="bg-white/10 backdrop-blur-md p-10 rounded-full mb-8 text-white shadow-inner animate-pulse-soft relative z-10">
                            ${icons.atom}
                        </div>
                        
                        <span class="inline-block px-4 py-1.5 rounded-full bg-white/20 backdrop-blur-sm text-sm font-semibold tracking-wide mb-6 border border-white/10">
                            ${courseData.info.grade}
                        </span>
                        
                        <h1 class="text-5xl md:text-6xl font-extrabold mb-4 tracking-tight leading-tight">
                            ${courseData.info.title}
                        </h1>
                        
                        <h2 class="text-2xl font-light text-blue-100 mb-10 max-w-2xl leading-relaxed">
                            ${courseData.info.topic}
                        </h2>
                        
                        <button onclick="setView('intro')" class="group bg-white text-blue-700 px-10 py-4 rounded-full font-bold text-lg shadow-xl btn-hover flex items-center gap-3 relative z-10">
                            Iniciar Trimestre 
                            <span class="group-hover:translate-x-1 transition-transform">${icons.arrowRight}</span>
                        </button>
                    </div>
                `;
            } 
            // 2. VISTA: INTRODUCCI√ìN
            else if (state.view === 'intro') {
                html += `
                    <div class="bg-white rounded-3xl shadow-xl border border-white/50 p-8 md:p-12 animate-enter">
                        <div class="flex items-center gap-3 mb-8">
                            <div class="h-10 w-1 bg-blue-600 rounded-full"></div>
                            <h2 class="text-3xl font-bold text-slate-900">Introducci√≥n</h2>
                        </div>
                        
                        <p class="text-slate-600 text-lg leading-relaxed mb-10">
                            ${courseData.info.description}
                        </p>
                        
                        <div class="bg-slate-50 rounded-2xl p-8 mb-10 border border-slate-200">
                            <h3 class="font-bold text-slate-800 mb-6 text-lg uppercase tracking-wide flex items-center gap-2">
                                <span class="bg-blue-100 text-blue-600 p-1 rounded">üéØ</span> Resultados de Aprendizaje
                            </h3>
                            <ul class="grid md:grid-cols-2 gap-4">
                                ${courseData.info.outcomes.map(o => `
                                    <li class="flex gap-3 items-start text-slate-700">
                                        <span class="mt-1.5 min-w-[6px] h-[6px] rounded-full bg-blue-500"></span> 
                                        ${o}
                                    </li>
                                `).join('')}
                            </ul>
                        </div>

                        <button onclick="setView('index')" class="w-full md:w-auto md:px-12 bg-blue-600 text-white py-4 rounded-xl font-bold text-lg hover:bg-blue-700 transition shadow-lg shadow-blue-600/20 flex justify-center items-center gap-2 mx-auto btn-hover">
                            Comenzar Lecciones ${icons.arrowRight}
                        </button>
                    </div>
                `;
            }
            // 3. VISTA: √çNDICE
            else if (state.view === 'index') {
                const progress = Math.round((state.completedLessons.length / courseData.lessons.length) * 100);
                
                html += `
                    <div class="animate-enter max-w-3xl mx-auto">
                        <div class="flex justify-between items-end mb-6">
                            <h2 class="text-2xl font-bold text-slate-900">Tu Progreso</h2>
                            <span class="text-sm font-bold text-blue-600">${progress}% Completado</span>
                        </div>
                        
                        <!-- Barra Progreso Estilizada -->
                        <div class="w-full bg-gray-200 rounded-full h-3 mb-10 overflow-hidden">
                            <div class="bg-gradient-to-r from-blue-500 to-indigo-600 h-3 rounded-full transition-all duration-700 ease-out shadow-[0_0_10px_rgba(59,130,246,0.5)]" style="width: ${progress}%"></div>
                        </div>

                        <div class="space-y-4">
                            ${courseData.lessons.map((lesson, idx) => {
                                const isCompleted = state.completedLessons.includes(lesson.id);
                                const isLocked = idx > 0 && !state.completedLessons.includes(courseData.lessons[idx-1].id);
                                
                                let containerClass = "p-5 rounded-2xl border transition-all duration-300 flex justify-between items-center group ";
                                let iconBg = "";
                                
                                if (isCompleted) {
                                    containerClass += "bg-green-50/50 border-green-200 cursor-pointer hover:shadow-md hover:border-green-300";
                                    iconBg = "bg-green-100 text-green-600";
                                } else if (isLocked) {
                                    containerClass += "bg-gray-50 border-gray-100 opacity-60 cursor-not-allowed grayscale";
                                    iconBg = "bg-gray-200 text-gray-400";
                                } else {
                                    containerClass += "bg-white border-gray-200 cursor-pointer hover:border-blue-400 hover:shadow-lg hover:-translate-y-1";
                                    iconBg = "bg-blue-50 text-blue-600 group-hover:bg-blue-600 group-hover:text-white transition-colors";
                                }
                                
                                return `
                                <div onclick="${!isLocked ? `selectLesson(${lesson.id})` : ''}" class="${containerClass}">
                                    <div class="flex items-center gap-5">
                                        <div class="w-14 h-14 rounded-2xl flex items-center justify-center font-bold text-lg shadow-sm ${iconBg}">
                                            ${isCompleted ? icons.check : (isLocked ? icons.lock : (idx + 1))}
                                        </div>
                                        <div>
                                            <h3 class="font-bold text-lg ${isCompleted ? 'text-green-800' : 'text-slate-800'}">${lesson.title}</h3>
                                            <div class="flex items-center text-xs text-slate-500 mt-1 font-semibold uppercase tracking-wider">
                                                ${icons.play} <span class="ml-1.5">${lesson.duration}</span>
                                            </div>
                                        </div>
                                    </div>
                                    ${!isLocked && !isCompleted ? `<div class="p-2 bg-gray-50 rounded-full text-gray-400 group-hover:text-blue-600 group-hover:bg-blue-50 transition-colors">${icons.arrowRight}</div>` : ''}
                                </div>`;
                            }).join('')}
                        </div>
                    </div>
                `;
            }
            // 4. VISTA: LECCI√ìN
            else if (state.view === 'lesson') {
                const lesson = courseData.lessons.find(l => l.id === state.activeLessonId);
                const isCompleted = state.completedLessons.includes(lesson.id);

                html += `
                    <div class="bg-white rounded-3xl shadow-2xl border border-gray-100 overflow-hidden animate-slide-in">
                        <!-- Header Sticky -->
                        <div class="bg-white/95 backdrop-blur border-b border-gray-100 p-4 sticky top-0 z-20 flex items-center justify-between">
                            <button onclick="setView('index')" class="flex items-center text-slate-500 hover:text-blue-700 font-semibold transition px-2 py-1 rounded-lg hover:bg-slate-50">
                                ${icons.arrowLeft} <span class="ml-2">Volver al √çndice</span>
                            </button>
                            <span class="text-xs font-bold uppercase text-slate-400 tracking-widest hidden md:block">Unidad de Aprendizaje</span>
                        </div>

                        <div class="p-8 md:p-12 max-w-3xl mx-auto">
                            <h1 class="text-4xl font-extrabold text-slate-900 mb-8 tracking-tight">${lesson.title}</h1>
                            
                            <div class="lesson-content mb-12">
                                ${lesson.content}
                            </div>

                            <div class="mt-12 pt-8 border-t border-gray-100" id="quiz-container">
                                ${isCompleted 
                                    ? `
                                    <div class="p-8 bg-green-50 rounded-2xl border border-green-200 text-center animate-enter">
                                        <div class="text-green-500 flex justify-center mb-4 transform scale-125">${icons.award}</div>
                                        <h3 class="text-2xl font-bold text-green-800 mb-2">¬°Lecci√≥n Completada!</h3>
                                        <p class="text-green-700 mb-6">Has demostrado dominio de este tema.</p>
                                        <button onclick="setView('index')" class="px-8 py-3 bg-green-600 text-white rounded-xl font-bold hover:bg-green-700 transition shadow-lg shadow-green-600/20 btn-hover">Continuar al √çndice</button>
                                    </div>` 
                                    : `
                                    <div class="bg-slate-50 rounded-2xl p-8 border border-slate-200">
                                        <h3 class="text-lg font-bold text-slate-800 mb-4 flex items-center gap-2">
                                            <span class="bg-indigo-100 text-indigo-600 p-1.5 rounded-lg">üìù</span> Evaluaci√≥n R√°pida
                                        </h3>
                                        <p class="mb-6 text-slate-700 font-medium text-lg">${lesson.quiz.question}</p>
                                        <div class="space-y-3">
                                            ${lesson.quiz.options.map((opt, idx) => `
                                                <button onclick="checkAnswer(${idx}, ${lesson.quiz.correct}, ${lesson.id})" class="quiz-btn w-full text-left p-4 rounded-xl border-2 border-transparent bg-white shadow-sm hover:border-blue-300 hover:shadow-md transition-all duration-200 text-slate-600 font-medium" id="opt-${idx}">
                                                    ${opt}
                                                </button>
                                            `).join('')}
                                        </div>
                                        <div id="feedback" class="mt-4 hidden p-4 rounded-xl font-bold text-center"></div>
                                    </div>
                                    `
                                }
                            </div>
                        </div>
                    </div>
                `;
            }
            // 5. VISTA: FIN
            else if (state.view === 'end') {
                html += `
                    <div class="min-h-[600px] flex flex-col items-center justify-center text-center p-8 bg-white rounded-3xl shadow-2xl animate-enter border border-slate-100">
                        <div class="relative mb-8">
                            <div class="absolute inset-0 bg-yellow-400 blur-2xl opacity-20 rounded-full animate-pulse-soft"></div>
                            <div class="text-yellow-500 relative transform scale-150">${icons.award}</div>
                        </div>
                        
                        <h2 class="text-5xl font-extrabold text-slate-900 mb-4 tracking-tight">¬°Trimestre Superado!</h2>
                        <p class="text-xl text-slate-500 max-w-lg mb-10 leading-relaxed">
                            Has completado con √©xito todas las unidades de Estructura At√≥mica y Tabla Peri√≥dica.
                        </p>
                        
                        <div class="flex gap-4">
                            <button onclick="restartCourse()" class="bg-slate-900 text-white px-8 py-3 rounded-full font-bold hover:bg-slate-800 transition shadow-lg btn-hover">
                                Repasar Trimestre
                            </button>
                        </div>
                    </div>
                `;
            }

            app.innerHTML = html;
        }

        // --- FUNCIONES DE L√ìGICA ---

        function setView(viewName) {
            state.view = viewName;
            render();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function selectLesson(id) {
            state.activeLessonId = id;
            setView('lesson');
        }

        function checkAnswer(selectedIdx, correctIdx, lessonId) {
            const feedbackEl = document.getElementById('feedback');
            const buttons = document.querySelectorAll('.quiz-btn');
            
            // Deshabilitar botones para evitar m√∫ltiples clics
            buttons.forEach(btn => btn.style.pointerEvents = 'none');
            
            if (selectedIdx === correctIdx) {
                // Estilos Correcto
                const btn = document.getElementById(`opt-${selectedIdx}`);
                btn.className = "quiz-btn w-full text-left p-4 rounded-xl border-2 border-green-500 bg-green-50 text-green-800 font-bold shadow-none";
                
                feedbackEl.textContent = "¬°Excelente! Respuesta Correcta.";
                feedbackEl.className = "mt-6 p-4 bg-green-100 text-green-800 rounded-xl font-bold text-center block animate-enter";
                
                // Actualizar estado
                if (!state.completedLessons.includes(lessonId)) {
                    state.completedLessons.push(lessonId);
                }

                setTimeout(() => {
                    if (state.completedLessons.length === courseData.lessons.length) {
                        setView('end');
                    } else {
                        setView('index');
                    }
                }, 1800);

            } else {
                // Estilos Incorrecto
                const btn = document.getElementById(`opt-${selectedIdx}`);
                btn.className = "quiz-btn w-full text-left p-4 rounded-xl border-2 border-red-400 bg-red-50 text-red-800 font-medium";
                
                feedbackEl.textContent = "Respuesta incorrecta, intenta de nuevo.";
                feedbackEl.className = "mt-6 p-4 bg-red-100 text-red-800 rounded-xl font-bold text-center block animate-enter";
                
                // Reactivar botones
                setTimeout(() => {
                    buttons.forEach(b => {
                        b.style.pointerEvents = 'auto';
                        if(b.id !== `opt-${selectedIdx}`) b.className = "quiz-btn w-full text-left p-4 rounded-xl border-2 border-transparent bg-white shadow-sm hover:border-blue-300 hover:shadow-md transition-all text-slate-600 font-medium";
                    });
                    btn.className = "quiz-btn w-full text-left p-4 rounded-xl border-2 border-transparent bg-white shadow-sm transition-all text-slate-400 font-medium opacity-50"; // Dejar marcado el error pero sutil
                    feedbackEl.className = "hidden";
                }, 2000);
            }
        }

        function restartCourse() {
            if(confirm("¬øSeguro que quieres reiniciar todo el progreso?")) {
                state.completedLessons = [];
                state.activeLessonId = null;
                setView('cover');
            }
        }

        // Inicializar
        render();

    </script>
</body>
</html>
